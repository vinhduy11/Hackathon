<html>
<head>
    <title>Thu hồi quà hết hạn</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link href="/css/mask.css" rel="stylesheet" type="text/css"/>
    <link href="/css/mycss.css" rel="stylesheet" type="text/css"/>
    <script src="/js/jquery.1.9.js"></script>
    <script src="/js/session.js"></script>
    <script src="/js/cookie.js"></script>
    <script type="text/javascript" src="/js/mask.js"></script>
    <script type="text/javascript" src="/js/myjs.js"></script>
</head>
<body>
<div id="mydiv">
    <h2>Thu hồi quà hết hạn</h2>
    <div style="float:left">
        <!--<b>Partner Code</b>: <input type="text" style="border:1px solid #778899; width:150px" name="sServiceId" id="sServiceId">-->
<!--        <b>Number</b>: <input type="text" style="border:1px solid #778899; width:150px" name="number"
                              id="numberId">
        <b>Group:
            <select id="groupId" name="groupId" style="width: 150px; font-size:14px; padding: 3px">
                <option value="">All</option>
                <option value="mgd">Muon gio dong</option>
                <option value="vcb">Vietcom Bank</option>
            </select>
        </b>-->
        <b>Number of select</b>: <input type="text" style="border:1px solid #778899; width:150px" name="number"
                              id="number">
        <input type="button" id="btnSearch" value="Xem">
        <input type="button" id="btnCollect" value="Thu hồi">
    </div>
    <div class="clear"></div>

    <div id="table"></div>

    <div class="clear"></div>

</div>
<script type="text/javascript">

    $(document).ready(function () {
            init();
    });

    $('#btnCollect').click(function () {
            getexpiredgift();
    });

    $('#btnSearch').click(function () {
            init();
    });

    function clearTable() {
        var head = "<tr>";
        head += "<th>Stt</th>";
        head += "<th>ID</th>";
        head += "<th>Gift Type</th>";
        head += "<th>Gia tien</th>";
        head += "<th>Ngay nhan</th>";
        head += "<th>Ngay nhan</th>";
        head += "<th>Ngay het han</th>";
        head += "<th>Ngay het han</th>";
        head += "<th>So dien thoai</th>";
        head += "<th>Trang thai</th>";
        head +="</tr>";
        $("#table").html(head);

    }

    function addItem(item) {
        var row;
        row = "<tr>";
        row += "<td> " + item.stt + " </td>";
        row += "<td> " + item._id + " </td>";
        row += "<td> " + item.typeId + " </td>";
        row += "<td> " + item.amount + "</td>";
        row += "<td> " + item.startDate + " </td>";
        row += "<td> " + item.start + " </td>";
        row += "<td> " + item.endDate + " </td>";
        row += "<td> " + item.end + " </td>";
        row += "<td> " + item.owner + " </td>";
        row += "<td> " + item.status + " </td>";
        row += "</tr>";

        $("#table").append(row);
    }

    function init() {
         $.ajax({
            url: "/searchexpiredgift",
            type: "GET",
            data: {
            number: $("#number").val()
            },
            success: function (array) {
                clearTable();
                for(i=0;i<array.length; i++){
                    addItem(array[i])
                }
            },
            error: function () {
                alert('Có lỗi kết nối xảy rsa');
            }
        });
    }

     function getexpiredgift() {
     $('#mydiv').mask("Dang thu hoi...");
         $.ajax({
            url: "/getexpiredgift",
            type: "GET",
            data: {
            number: $("#number").val()
            },
            success: function (array) {
                clearTable();
                $('#mydiv').unmask();
                for(i=0;i<array.length; i++){
                    addItem(array[i])
                }
            },
            error: function () {
                 $('#mydiv').unmask();
                alert('Có lỗi kết nối xảy rsa');
            }
        });
    }


</script>
</body>
</html>